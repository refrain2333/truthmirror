<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设置测试用户</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            text-align: center;
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .button:hover {
            background: #0056b3;
        }
        .success {
            background: #28a745;
        }
        .success:hover {
            background: #1e7e34;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <h1>设置测试用户</h1>
    <p>点击下面的按钮来设置测试用户，然后就可以正常提交事件了。</p>
    
    <div class="status" id="status">
        当前用户状态：未检查
    </div>
    
    <button class="button" onclick="setupTestUser()">设置测试用户</button>
    <button class="button success" onclick="goToSubmitPage()">前往提交事件页面</button>
    <button class="button" onclick="checkStatus()">检查当前状态</button>
    
    <script>
        function setupTestUser() {
            const testUser = {
                id: 2,
                username: 'testuser',
                nickname: '测试用户',
                role: 'user'
            };
            
            localStorage.setItem('currentUser', JSON.stringify(testUser));
            checkStatus();
            alert('测试用户设置成功！现在可以提交事件了。');
        }
        
        function checkStatus() {
            const userStr = localStorage.getItem('currentUser');
            const statusDiv = document.getElementById('status');
            
            if (userStr) {
                try {
                    const user = JSON.parse(userStr);
                    statusDiv.innerHTML = `
                        <strong>✅ 已登录</strong><br>
                        用户名: ${user.username}<br>
                        昵称: ${user.nickname}<br>
                        ID: ${user.id}
                    `;
                    statusDiv.style.background = '#d4edda';
                    statusDiv.style.color = '#155724';
                } catch (error) {
                    statusDiv.innerHTML = '❌ 用户数据格式错误';
                    statusDiv.style.background = '#f8d7da';
                    statusDiv.style.color = '#721c24';
                }
            } else {
                statusDiv.innerHTML = '❌ 未登录';
                statusDiv.style.background = '#f8d7da';
                statusDiv.style.color = '#721c24';
            }
        }
        
        function goToSubmitPage() {
            window.location.href = './submit-event.html';
        }
        
        // 页面加载时检查状态
        window.addEventListener('load', checkStatus);
    </script>
</body>
</html>
