# 真相之镜 (Truth Mirror)

基于AI分析和众包验证的事件真相验证平台。通过整合智能搜索、AI内容分析和用户投票机制，为网络事件提供客观、透明的真相验证服务。

## 🎯 核心理念

- **AI + 人工智能**：结合AI技术的高效分析和人类智慧的判断力
- **透明化流程**：完整展示验证过程，确保结果可信
- **众包验证**：通过社区协作提高验证结果的准确性和公正性
- **客观中立**：基于事实和证据，避免主观偏见

## 🚀 核心功能

### 1. 事件生命周期管理
完整的事件状态流转机制：
- **PENDING** (待审核) → **NOMINATED** (已提名) → **PROCESSING** (AI分析中) → **VOTING** (投票中) → **CONFIRMED** (已确认)

### 2. 智能触发机制
- **10人关注自动触发**：当事件获得10人关注时，自动启动AI分析
- **20票自动确认**：当投票达到20票时，自动确认事件状态

### 3. AI分析系统
7步智能分析流程：
1. **新闻获取**：从SearXNG API获取多源新闻数据
2. **连通性筛选**：异步检查URL可访问性
3. **AI相关性筛选**：使用GLM-4.5模型智能筛选
4. **内容提取**：智能解析HTML，提取新闻正文
5. **AI深度分析**：使用Gemini/DeepSeek模型专业分析
6. **数据处理**：结构化分析结果
7. **汇总报告**：生成综合性分析报告

### 4. 众包投票系统
- **投票机制**：用户基于AI分析进行支持/反对投票
- **权重计算**：根据用户信誉和参与度调整投票权重
- **结果展示**：实时显示投票统计和趋势

## 技术栈

- **后端**: FastAPI + Python 3.8+
- **数据库**: MySQL + PyMySQL
- **前端**: 纯HTML + CSS + JavaScript
- **AI集成**: OpenAI/Claude API (模拟实现)

## 快速启动

### 访问地址
- **前端**: http://127.0.0.1:8080
- **后端API**: http://127.0.0.1:8000
- **API文档**: http://127.0.0.1:8000/docs

## 一键启动（推荐）

为了简化启动流程，提供了批处理文件：

### Windows用户
```bash
# 主启动器（推荐）
启动项目.bat

# 或单独启动
启动前端.bat  # 仅启动前端服务
启动后端.bat  # 仅启动后端服务
```

### 手动启动
如果批处理文件无法使用，可以手动启动：

## 手动启动步骤
### 前端启动
```bash
# 进入前端目录
cd frontend

# 启动前端服务 (端口8080)
python -m http.server 8080 --bind 127.0.0.1 --directory .
```

### 后端启动
```bash
# 进入后端目录
cd backend

# 启动后端服务 (端口8000)
python run.py
```

### 注意事项
- 确保MySQL数据库已启动并完成初始化
- 后端服务需要先启动，前端才能正常调用API
- 首次使用需要在前端注册用户账号
- 如果前端显示目录列表，请直接访问 http://127.0.0.1:8080/index.html
- 推荐使用批处理文件启动，避免路径和命令错误

## 📁 项目结构

```
truthmirror/
├── backend/                    # 后端服务
│   ├── app/                   # FastAPI应用
│   │   ├── api/              # API路由
│   │   ├── services/         # 业务逻辑
│   │   └── main.py           # 应用入口
│   └── run.py                # 启动脚本
├── frontend/                  # 前端页面
│   ├── index.html            # 主页
│   ├── event-detail.html     # 事件详情
│   └── js/api.js             # API调用
├── modules/                   # 功能模块
│   └── TruthNews/            # AI分析模块
│       └── news_analysis/    # 7步分析流程
└── test/                     # 测试脚本
```

## 🔧 配置说明

### 必需配置
1. **数据库配置**：修改 `backend/app/services/simple_db_service.py` 中的连接参数
2. **AI API密钥**：配置 `modules/TruthNews/news_analysis/.env` 文件
   - GLM_API_KEY（主要AI分析）
   - DEEPSEEK_API_KEY（备选方案）
   - GEMINI_API_KEY（深度分析）

### 可选配置
- SearXNG搜索引擎URL
- AI模型参数调优
- 触发阈值设置（10人关注，20票确认）

## 🎯 使用指南

### 用户流程
1. **注册登录**：创建账户，获得参与权限
2. **提交事件**：描述需要验证的事件
3. **关注事件**：对感兴趣的事件表达关注
4. **AI分析**：10人关注后自动触发智能分析
5. **投票验证**：基于AI分析结果进行投票
6. **真相确认**：20票后自动确认事件状态

### 管理员功能
- 事件审核管理
- 用户权限控制
- 系统参数配置
- 数据统计分析

## 📊 系统特色

### AI分析能力
- **多源信息聚合**：整合多个新闻源
- **智能相关性筛选**：过滤无关信息
- **深度内容分析**：生成专业分析报告
- **可信度评级**：四级评级系统（可靠/存疑/不可靠/信息不足）

### 众包验证机制
- **民主投票**：社区协作验证
- **透明流程**：完整展示分析过程
- **权重调节**：根据用户信誉调整投票权重
- **自动确认**：达到阈值自动确认结果

## 📝 开发规范

### 核心原则
- **扩展不重写**：保持现有功能完整性
- **模块化设计**：功能独立，便于维护
- **透明化开发**：过程公开，结果可追溯
- **用户体验优先**：界面友好，操作简便

### 技术要求
- 后端API遵循RESTful规范
- 前端使用原生JavaScript，避免框架依赖
- 数据库设计规范化，支持高并发
- AI分析模块支持多模型切换

## 📄 许可证

MIT License - 详见 LICENSE 文件
